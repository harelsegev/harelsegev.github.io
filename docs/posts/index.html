<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Posts | RAT In Mi Kitchen</title>
<meta name="keywords" content="">
<meta name="description" content="Posts - RAT In Mi Kitchen">
<meta name="author" content="Harel Segev">
<link rel="canonical" href="https://harelsegev.github.io/posts/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.0b739a2e2c5e5656e4bcd5f0b2268d063addaf81d89ec3987d6af8f04decdc97.css" integrity="sha256-C3OaLixeVlbkvNXwsiaNBjrdr4HYnsOYfWr48E3s3Jc=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://harelsegev.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://harelsegev.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://harelsegev.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://harelsegev.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://harelsegev.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://harelsegev.github.io/posts/index.xml">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="Posts" />
<meta property="og:description" content="my DFIR blog" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://harelsegev.github.io/posts/" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Posts"/>
<meta name="twitter:description" content="my DFIR blog"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://harelsegev.github.io/posts/"
    }
  ]
}
</script>
</head>

<body class="list dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://harelsegev.github.io/" accesskey="h" title="RAT In Mi Kitchen (Alt + H)">RAT In Mi Kitchen</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://harelsegev.github.io/posts/" title="Posts">
                    <span class="active">Posts</span>
                </a>
            </li>
            <li>
                <a href="https://harelsegev.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://harelsegev.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://harelsegev.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://harelsegev.github.io/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header"><div class="breadcrumbs"><a href="https://harelsegev.github.io/">Home</a></div>
  <h1>
    Posts
    <a href="index.xml" title="RSS" aria-label="RSS">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round" height="23">
        <path d="M4 11a9 9 0 0 1 9 9" />
        <path d="M4 4a16 16 0 0 1 16 16" />
        <circle cx="5" cy="19" r="1" />
      </svg>
    </a>
  </h1>
</header>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>$I30 Parsers Output False Entries. Here&#39;s Why
    </h2>
  </header>
  <div class="entry-content">
    <p>In the README page of my tool, INDXRipper (Go check it out! It’s really cool), down in the “Limitations” section, I gave some warnings regarding the reliability of the tool:
The tool may give false results. While false positives are rare, they are possible.
Partially overwritten entries may not be found. If they are found, though, the tool may give you false information.
These shortcomings apply to every $I30 parser, and in this post - I’ll explain why....</p>
  </div>
  <footer class="entry-footer"><span title='2022-10-29 00:00:00 +0000 UTC'>October 29, 2022</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;1322 words&nbsp;·&nbsp;Harel Segev</footer>
  <a class="entry-link" aria-label="post link to $I30 Parsers Output False Entries. Here&#39;s Why" href="https://harelsegev.github.io/posts/i30-parsers-output-false-entries.-heres-why/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>The Forensic Value of the (Other) WSH Registry Key
    </h2>
  </header>
  <div class="entry-content">
    <p>WSH (Windows Script Host) is an automation tool built into Windows, providing powerful scripting abilities. It was introduced in Windows 98, long predating .NET and PowerShell. Whilst being largely abandoned by system administrators, It is sometimes used by attackers to evade detection and obfuscate their infection chains.
Typically, an attacker will drop a malicious script on disk - a .vbs, .js or a .wsf file, and then execute it using either the WScript or the CScript host....</p>
  </div>
  <footer class="entry-footer"><span title='2022-10-13 00:00:00 +0000 UTC'>October 13, 2022</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;379 words&nbsp;·&nbsp;Harel Segev</footer>
  <a class="entry-link" aria-label="post link to The Forensic Value of the (Other) WSH Registry Key" href="https://harelsegev.github.io/posts/the-forensic-value-of-the-other-wsh-registry-key/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>The Mystery of the HeapLeakDetection Registry Key
    </h2>
  </header>
  <div class="entry-content">
    <p>I was working on a case the other day, when I first came across a rather interesting registry key, HKLM\Software\Microsoft\RADAR\HeapLeakDetection\DiagnosedApplications. It caught my eye, because it has sub-keys for (what appears to be) applications executed on the system. This is what it looks like on my own system:
It has quite a few sub-keys, and each one has a LastDetectionTime QWORD value, containing what appears to be a Windows FILETIME timestamp:...</p>
  </div>
  <footer class="entry-footer"><span title='2022-07-20 00:00:00 +0000 UTC'>July 20, 2022</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1070 words&nbsp;·&nbsp;Harel Segev</footer>
  <a class="entry-link" aria-label="post link to The Mystery of the HeapLeakDetection Registry Key" href="https://harelsegev.github.io/posts/the-mystery-of-the-heapleakdetection-registry-key/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Resolving File Paths Using the MFT
    </h2>
  </header>
  <div class="entry-content">
    <p>In NTFS, the MFT (Master File Table) is a structure that contains a lot of the file-system metadata, and also the contents of small files. It is stored in a special file, called $MFT. In incident response, we often collect and parse this file to determine the file system contents and how it changed over time, without having to acquire a full disk image.
There are many bad MFT parsers out there....</p>
  </div>
  <footer class="entry-footer"><span title='2022-07-07 00:00:00 +0000 UTC'>July 7, 2022</span>&nbsp;·&nbsp;16 min&nbsp;·&nbsp;3401 words&nbsp;·&nbsp;Harel Segev</footer>
  <a class="entry-link" aria-label="post link to Resolving File Paths Using the MFT" href="https://harelsegev.github.io/posts/resolving-file-paths-using-the-mft/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Home Adventures! A Prefetch File in $I30 Slack, PyInstaller &amp; Prefetch Hash Cracking
    </h2>
  </header>
  <div class="entry-content">
    <p>I often test my tools on my old computer at home. It’s so much more interesting to investigate than a newly created virtual machine. Today, while testing, I found evidence of activity from almost 2 years ago. It got me really excited, and I thought it would make a cool blog post!
Here’s a snippet from the timeline I created using MFTECmd and INDXRipper:
A Prefetch File in $I30 Slack The Prefetch file FLOSS64....</p>
  </div>
  <footer class="entry-footer"><span title='2022-07-02 00:00:00 +0000 UTC'>July 2, 2022</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;881 words&nbsp;·&nbsp;Harel Segev</footer>
  <a class="entry-link" aria-label="post link to Home Adventures! A Prefetch File in $I30 Slack, PyInstaller &amp; Prefetch Hash Cracking" href="https://harelsegev.github.io/posts/home-adventures/home-adventures-a-prefetch-file-in-i30-slack-pyinstaller-prefetch-hash-cracking/"></a>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://harelsegev.github.io/">RAT In Mi Kitchen</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
